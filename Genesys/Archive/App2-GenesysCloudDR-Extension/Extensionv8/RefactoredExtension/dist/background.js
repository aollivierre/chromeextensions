/*! For license information please see background.js.LICENSE.txt */
(()=>{"use strict";var t={"70af5856-802a-423a-b07a-5f420c8e325d":"dr","d9ee1fd7-868c-4ea0-af89-5b9813db863d":"test","a7cbe8fc-fe81-47bc-bdd3-05a726c56c5a":"dev"},e={"cac1.pure.cloud":"test","usw2.pure.cloud":"test","use2.pure.cloud":"test","fra.pure.cloud":"test","login.mypurecloud.ca":"test","use1.dev.us-east-1.aws.dev.genesys.cloud":"dev","dev.genesys.cloud":"dev","dr.mypurecloud.com":"dr","dr-api.mypurecloud.com":"dr"},r=["/api/v2/organizations/me","/api/v2/users/me","/api/v2/authorization/roles","/api/v2/tokens/me"],n={ORG_ID:{confidence:.95,name:"Organization ID"},HOSTNAME:{confidence:.95,name:"Hostname"},API_ENDPOINT:{confidence:.9,name:"API Endpoint"},URL_PATTERN:{confidence:.85,name:"URL Pattern"},TITLE_PATTERN:{confidence:.8,name:"Page Title"},MANUAL_OVERRIDE:{confidence:1,name:"Manual Override"},DEFAULT:{confidence:.5,name:"Default"}};function o(){for(var t,e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];(t=console).log.apply(t,["[Environment Extension]"].concat(r))}function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function c(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach((function(e){u(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function u(t,e,r){return(e=p(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function s(){s=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function h(t,e,r,n){var i=e&&e.prototype instanceof b?e:b,a=Object.create(i.prototype),c=new _(n||[]);return o(a,"_invoke",{value:S(t,r,c)}),a}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var d="suspendedStart",v="suspendedYield",y="executing",m="completed",g={};function b(){}function w(){}function E(){}var x={};f(x,c,(function(){return this}));var k=Object.getPrototypeOf,L=k&&k(k(A([])));L&&L!==r&&n.call(L,c)&&(x=L);var O=E.prototype=b.prototype=Object.create(x);function I(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function r(o,a,c,u){var s=p(t[o],t,a);if("throw"!==s.type){var l=s.arg,f=l.value;return f&&"object"==i(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,c,u)}),(function(t){r("throw",t,c,u)})):e.resolve(f).then((function(t){l.value=t,c(l)}),(function(t){return r("throw",t,c,u)}))}u(s.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function S(e,r,n){var o=d;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=P(c,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=p(e,r,n);if("normal"===s.type){if(o=n.done?m:v,s.arg===g)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=m,n.method="throw",n.arg=s.arg)}}}function P(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=p(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[c];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(i(e)+" is not iterable")}return w.prototype=E,o(O,"constructor",{value:E,configurable:!0}),o(E,"constructor",{value:w,configurable:!0}),w.displayName=f(E,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,E):(t.__proto__=E,f(t,l,"GeneratorFunction")),t.prototype=Object.create(O),t},e.awrap=function(t){return{__await:t}},I(T.prototype),f(T.prototype,u,(function(){return this})),e.AsyncIterator=T,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new T(h(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},I(O),f(O,l,"Generator"),f(O,c,(function(){return this})),f(O,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function l(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function f(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){l(i,n,o,a,c,"next",t)}function c(t){l(i,n,o,a,c,"throw",t)}a(void 0)}))}}function h(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,p(n.key),n)}}function p(t){var e=function(t){if("object"!=i(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==i(e)?e:e+""}const d=new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.initialized=!1,this.cachedData={}},e=[{key:"initialize",value:(y=f(s().mark((function t(){var e;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.initialized){t.next=2;break}return t.abrupt("return",!0);case 2:return t.prev=2,o("Initializing storage service"),t.next=6,this.getAll();case 6:return e=t.sent,this.cachedData=e,this.initialized=!0,o("Storage service initialized with data:",this.cachedData),t.abrupt("return",!0);case 13:return t.prev=13,t.t0=t.catch(2),o("Error initializing storage service:",t.t0),t.abrupt("return",!1);case 17:case"end":return t.stop()}}),t,this,[[2,13]])}))),function(){return y.apply(this,arguments)})},{key:"get",value:(v=f(s().mark((function t(e){var r=this;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,void 0===this.cachedData[e]){t.next=3;break}return t.abrupt("return",this.cachedData[e]);case 3:return t.abrupt("return",new Promise((function(t){chrome.storage.sync.get(e,(function(n){chrome.runtime.lastError?(o("Error getting data from storage:",chrome.runtime.lastError),t(void 0)):(r.cachedData[e]=n[e],t(n[e]))}))})));case 6:return t.prev=6,t.t0=t.catch(0),o("Error in get:",t.t0),t.abrupt("return",void 0);case 10:case"end":return t.stop()}}),t,this,[[0,6]])}))),function(t){return v.apply(this,arguments)})},{key:"getMultiple",value:(d=f(s().mark((function t(e){var r,n=this;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!e.every((function(t){return void 0!==n.cachedData[t]}))){t.next=6;break}return r={},e.forEach((function(t){r[t]=n.cachedData[t]})),t.abrupt("return",r);case 6:return t.abrupt("return",new Promise((function(t){chrome.storage.sync.get(e,(function(e){chrome.runtime.lastError?(o("Error getting multiple data from storage:",chrome.runtime.lastError),t({})):(Object.keys(e).forEach((function(t){n.cachedData[t]=e[t]})),t(e))}))})));case 9:return t.prev=9,t.t0=t.catch(0),o("Error in getMultiple:",t.t0),t.abrupt("return",{});case 13:case"end":return t.stop()}}),t,null,[[0,9]])}))),function(t){return d.apply(this,arguments)})},{key:"getAll",value:(p=f(s().mark((function t(){var e=this;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.abrupt("return",new Promise((function(t){chrome.storage.sync.get(null,(function(r){chrome.runtime.lastError?(o("Error getting all data from storage:",chrome.runtime.lastError),t({})):(e.cachedData=c({},r),t(r))}))})));case 4:return t.prev=4,t.t0=t.catch(0),o("Error in getAll:",t.t0),t.abrupt("return",{});case 8:case"end":return t.stop()}}),t,null,[[0,4]])}))),function(){return p.apply(this,arguments)})},{key:"set",value:(l=f(s().mark((function t(e,r){var n=this;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this.cachedData[e]=r,t.abrupt("return",new Promise((function(t){var i=u({},e,r);chrome.storage.sync.set(i,(function(){chrome.runtime.lastError?(o("Error setting data in storage:",chrome.runtime.lastError),delete n.cachedData[e],t(!1)):t(!0)}))})));case 5:return t.prev=5,t.t0=t.catch(0),o("Error in set:",t.t0),t.abrupt("return",!1);case 9:case"end":return t.stop()}}),t,this,[[0,5]])}))),function(t,e){return l.apply(this,arguments)})},{key:"setMultiple",value:(a=f(s().mark((function t(e){var r=this;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this.cachedData=c(c({},this.cachedData),e),t.abrupt("return",new Promise((function(t){chrome.storage.sync.set(e,(function(){chrome.runtime.lastError?(o("Error setting multiple data in storage:",chrome.runtime.lastError),r.getAll().then((function(){return t(!1)}))):t(!0)}))})));case 5:return t.prev=5,t.t0=t.catch(0),o("Error in setMultiple:",t.t0),t.abrupt("return",!1);case 9:case"end":return t.stop()}}),t,this,[[0,5]])}))),function(t){return a.apply(this,arguments)})},{key:"remove",value:(i=f(s().mark((function t(e){var r=this;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,delete this.cachedData[e],t.abrupt("return",new Promise((function(t){chrome.storage.sync.remove(e,(function(){chrome.runtime.lastError?(o("Error removing data from storage:",chrome.runtime.lastError),r.get(e).then((function(n){r.cachedData[e]=n,t(!1)}))):t(!0)}))})));case 5:return t.prev=5,t.t0=t.catch(0),o("Error in remove:",t.t0),t.abrupt("return",!1);case 9:case"end":return t.stop()}}),t,this,[[0,5]])}))),function(t){return i.apply(this,arguments)})},{key:"removeMultiple",value:(n=f(s().mark((function t(e){var r=this;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.forEach((function(t){delete r.cachedData[t]})),t.abrupt("return",new Promise((function(t){chrome.storage.sync.remove(e,(function(){chrome.runtime.lastError?(o("Error removing multiple data from storage:",chrome.runtime.lastError),r.getAll().then((function(){return t(!1)}))):t(!0)}))})));case 5:return t.prev=5,t.t0=t.catch(0),o("Error in removeMultiple:",t.t0),t.abrupt("return",!1);case 9:case"end":return t.stop()}}),t,null,[[0,5]])}))),function(t){return n.apply(this,arguments)})},{key:"clear",value:(r=f(s().mark((function t(){var e=this;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this.cachedData={},t.abrupt("return",new Promise((function(t){chrome.storage.sync.clear((function(){chrome.runtime.lastError?(o("Error clearing storage:",chrome.runtime.lastError),e.getAll().then((function(){return t(!1)}))):t(!0)}))})));case 5:return t.prev=5,t.t0=t.catch(0),o("Error in clear:",t.t0),t.abrupt("return",!1);case 9:case"end":return t.stop()}}),t,this,[[0,5]])}))),function(){return r.apply(this,arguments)})}],e&&h(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,i,a,l,p,d,v,y}());var v=[".dr.","-dr.","-dr-","/dr/","wawanesa-dr","disaster","failover","recovery","dr-region"],y=[".test.","-test-","wawanesa-test","staging","qa","uat","testing","test-region"],m=[".dev.","-dev-","wawanesa-dev","development","dev-region","sandbox"],g=[".dr.","-dr.","-dr-","/dr/","wawanesa-dr"],b={dr:["directory","drive","drop","draw","drawer","address"],test:["latest","greatest","contest","testimony","protest","attestation","intestate"]},w=["pure.cloud","mypurecloud.com","genesys.cloud"];function E(t){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E(t)}function x(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=L(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){c=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw i}}}}function k(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,s=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==e);u=!0);}catch(t){s=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(t,e)||L(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(t,e){if(t){if("string"==typeof t)return O(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?O(t,e):void 0}}function O(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function I(){I=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new _(n||[]);return o(a,"_invoke",{value:S(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};s(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(A([])));k&&k!==r&&n.call(k,a)&&(w=k);var L=b.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function r(o,i,a,c){var u=f(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==E(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function S(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=P(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function P(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(E(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=s(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,s(t,u,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},O(T.prototype),s(T.prototype,c,(function(){return this})),e.AsyncIterator=T,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new T(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(L),s(L,u,"Generator"),s(L,a,(function(){return this})),s(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function T(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function S(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){T(i,n,o,a,c,"next",t)}function c(t){T(i,n,o,a,c,"throw",t)}a(void 0)}))}}function P(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,j(n.key),n)}}function j(t){var e=function(t){if("object"!=E(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=E(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==E(e)?e:e+""}const D=new(function(){return r=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.initialized=!1,this.currentEnvironment=null,this.detectedOrgId=null,this.lastDetectionMethod=null,this.lastDetectionSource=null,this.lastDetectionTime=null,this.processedUrls=new Set,this.tabEnvironmentCache=new Map},i=[{key:"initialize",value:(p=S(I().mark((function t(){var e;return I().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.initialized){t.next=2;break}return t.abrupt("return",!0);case 2:return t.prev=2,o("Initializing environment service"),t.next=6,d.getMultiple(["environmentType","detectedOrgId","detectionMethod","detectionSource","lastUpdated"]);case 6:return(e=t.sent).environmentType&&(this.currentEnvironment=e.environmentType,o("Loaded environment type:",this.currentEnvironment)),e.detectedOrgId&&(this.detectedOrgId=e.detectedOrgId,o("Loaded organization ID:",this.detectedOrgId)),e.detectionMethod&&(this.lastDetectionMethod=e.detectionMethod,o("Loaded detection method:",this.lastDetectionMethod)),e.detectionSource&&(this.lastDetectionSource=e.detectionSource,o("Loaded detection source:",this.lastDetectionSource)),e.lastUpdated&&(this.lastDetectionTime=e.lastUpdated,o("Loaded last detection time:",this.lastDetectionTime)),this.initialized=!0,o("Environment service initialized"),t.abrupt("return",!0);case 17:return t.prev=17,t.t0=t.catch(2),o("Error initializing environment service:",t.t0),t.abrupt("return",!1);case 21:case"end":return t.stop()}}),t,this,[[2,17]])}))),function(){return p.apply(this,arguments)})},{key:"checkUrlForEnvironment",value:(h=S(I().mark((function t(r,i){var a,c,u,s,l,f,h,p,w,E,L,O,T,S,P,j,D,_,A,z,R,N,U,M,G,F,C,H,V,Y,q,W;return I().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,a=i.toLowerCase(),c=new URL(a),u=c.hostname.toLowerCase(),s=c.pathname,l="".concat(u).concat(s).concat(c.hash),f=g.some((function(t){return a.includes(t)})),!f){t.next=14;break}return o("Strong DR pattern found in URL: ".concat(i)),h=g.find((function(t){return a.includes(t)})),p={environment:"dr",tabId:r,url:i,orgId:null,method:n.URL_PATTERN.name,source:"strong-dr-pattern:".concat(h),confidence:n.URL_PATTERN.confidence},t.next=13,this.updateEnvironment(p);case 13:return t.abrupt("return",p);case 14:return t.next=16,d.getMultiple(["environmentType","detectionMethod"]);case 16:if(w=t.sent,E=g.some((function(t){return a.includes(t)})),!E){t.next=25;break}return o("Strong DR pattern found in URL during standard detection: ".concat(i)),L=g.find((function(t){return a.includes(t)})),O={environment:"dr",tabId:r,url:i,orgId:null,method:n.URL_PATTERN.name,source:"strong-dr-pattern:".concat(L),confidence:n.URL_PATTERN.confidence},t.next=24,this.updateEnvironment(O);case 24:return t.abrupt("return",O);case 25:if(!w.environmentType||w.detectionMethod!==n.ORG_ID.name){t.next=28;break}return o("Already have high-confidence detection (".concat(w.detectionMethod,"): ").concat(w.environmentType,", skipping URL pattern detection")),t.abrupt("return",null);case 28:T=0,S=Object.entries(e);case 29:if(!(T<S.length)){t.next=40;break}if(P=k(S[T],2),j=P[0],D=P[1],!u.includes(j)){t.next=37;break}return o("Hostname match: ".concat(j," -> ").concat(D)),_={environment:D,tabId:r,url:i,orgId:null,method:n.HOSTNAME.name,source:j,confidence:n.HOSTNAME.confidence},t.next=36,this.updateEnvironment(_);case 36:return t.abrupt("return",_);case 37:T++,t.next=29;break;case 40:if(b.dr.some((function(t){return l.includes(t)}))){t.next=69;break}if(!u.includes("login")||!l.includes("wawanesa-dr")){t.next=48;break}return o("Found DR login URL with organization name"),A={environment:"dr",tabId:r,url:i,orgId:null,method:n.URL_PATTERN.name,source:"login-wawanesa-dr",confidence:n.URL_PATTERN.confidence},t.next=47,this.updateEnvironment(A);case 47:return t.abrupt("return",A);case 48:z=x(v),t.prev=49,z.s();case 51:if((R=z.n()).done){t.next=61;break}if(N=R.value,!a.includes(N)){t.next=59;break}return o("DR pattern match in URL: ".concat(N)),U={environment:"dr",tabId:r,url:i,orgId:null,method:n.URL_PATTERN.name,source:"url-pattern:".concat(N),confidence:n.URL_PATTERN.confidence},t.next=58,this.updateEnvironment(U);case 58:return t.abrupt("return",U);case 59:t.next=51;break;case 61:t.next=66;break;case 63:t.prev=63,t.t0=t.catch(49),z.e(t.t0);case 66:return t.prev=66,z.f(),t.finish(66);case 69:M=x(y),t.prev=70,M.s();case 72:if((G=M.n()).done){t.next=82;break}if(F=G.value,!a.includes(F)){t.next=80;break}return o("TEST pattern match in URL: ".concat(F)),C={environment:"test",tabId:r,url:i,orgId:null,method:n.URL_PATTERN.name,source:"url-pattern:".concat(F),confidence:n.URL_PATTERN.confidence},t.next=79,this.updateEnvironment(C);case 79:return t.abrupt("return",C);case 80:t.next=72;break;case 82:t.next=87;break;case 84:t.prev=84,t.t1=t.catch(70),M.e(t.t1);case 87:return t.prev=87,M.f(),t.finish(87);case 90:H=x(m),t.prev=91,H.s();case 93:if((V=H.n()).done){t.next=103;break}if(Y=V.value,!a.includes(Y)){t.next=101;break}return o("DEV pattern match in URL: ".concat(Y)),q={environment:"dev",tabId:r,url:i,orgId:null,method:n.URL_PATTERN.name,source:"url-pattern:".concat(Y),confidence:n.URL_PATTERN.confidence},t.next=100,this.updateEnvironment(q);case 100:return t.abrupt("return",q);case 101:t.next=93;break;case 103:t.next=108;break;case 105:t.prev=105,t.t2=t.catch(91),H.e(t.t2);case 108:return t.prev=108,H.f(),t.finish(108);case 111:if(!s.includes("/api/")){t.next=118;break}if(!s.includes("/dr/")&&!s.includes("/dr-api/")){t.next=118;break}return o("DR API endpoint detected in path"),W={environment:"dr",tabId:r,url:i,orgId:null,method:n.API_ENDPOINT.name,source:s,confidence:n.API_ENDPOINT.confidence},t.next=117,this.updateEnvironment(W);case 117:return t.abrupt("return",W);case 118:return o("No environment indicators found in URL"),t.abrupt("return",null);case 122:return t.prev=122,t.t3=t.catch(0),o("Error checking URL:",t.t3),t.abrupt("return",null);case 126:case"end":return t.stop()}}),t,this,[[0,122],[49,63,66,69],[70,84,87,90],[91,105,108,111]])}))),function(t,e){return h.apply(this,arguments)})},{key:"processOrganizationId",value:(f=S(I().mark((function e(r,i){var a,c,u,s=arguments;return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=s.length>2&&void 0!==s[2]?s[2]:null,r&&"string"==typeof r){e.next=4;break}return o("Invalid organization ID:",r),e.abrupt("return",null);case 4:if(c=t[r]){e.next=8;break}return o("Organization ID ".concat(r," not found in mappings")),e.abrupt("return",null);case 8:return o("Organization ID ".concat(r," mapped to environment: ").concat(c)),u={environment:c,tabId:a,orgId:r,method:n.ORG_ID.name,source:i||"unknown",confidence:n.ORG_ID.confidence},e.next=12,this.updateEnvironment(u);case 12:return e.abrupt("return",u);case 13:case"end":return e.stop()}}),e,this)}))),function(t,e){return f.apply(this,arguments)})},{key:"updateEnvironment",value:(l=S(I().mark((function t(e){var r,i,a,c,u,s,l,f,h;return I().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e&&e.environment){t.next=3;break}return o("Invalid detection result, skipping update"),t.abrupt("return",!1);case 3:if(r=e.environment,i=e.orgId,a=e.method,c=e.source,u=e.confidence,s=this.lastDetectionMethod?(n[this.lastDetectionMethod]||n.DEFAULT).confidence:0,l=u||(n[a]||n.DEFAULT).confidence,"test"!==r&&"dev"!==r||!i||a!==n.ORG_ID.name){t.next=10;break}o("Updating TEST/DEV environment with org ID detection: ".concat(i)),t.next=13;break;case 10:if(r!==this.currentEnvironment||null!==i&&i!==this.detectedOrgId){t.next=13;break}return o("Same environment ".concat(r," already detected, skipping update")),t.abrupt("return",!1);case 13:if("test"!==this.currentEnvironment||"dr"!==r){t.next=23;break}if(a!==n.HOSTNAME.name&&a!==n.URL_PATTERN.name){t.next=18;break}o("Allowing DR detection (".concat(a,": ").concat(c,") to override TEST detection because URL indicates DR environment")),t.next=21;break;case 18:if(!(s>l)){t.next=21;break}return o("Ignoring ".concat(r," detection from ").concat(a," (confidence: ").concat(l,") ")+"because we already have ".concat(this.currentEnvironment," from ").concat(this.lastDetectionMethod," (confidence: ").concat(s,")")),t.abrupt("return",!1);case 21:t.next=26;break;case 23:if(!(null!==this.currentEnvironment&&s>l)){t.next=26;break}return o("Ignoring ".concat(r," detection from ").concat(a," (confidence: ").concat(l,") ")+"because we already have ".concat(this.currentEnvironment," from ").concat(this.lastDetectionMethod," (confidence: ").concat(s,")")),t.abrupt("return",!1);case 26:return o("Updating environment to ".concat(r," (").concat(a,": ").concat(c,")")),this.currentEnvironment=r,i&&(this.detectedOrgId=i),f=a,h=c,"test"!==r&&"dev"!==r||!i||(a===n.ORG_ID.name?(f=a,h=c):a!==n.HOSTNAME.name&&a!==n.URL_PATTERN.name||(f="URL+OrgID",h="".concat(c," + ").concat(i))),this.lastDetectionMethod=f,this.lastDetectionSource=h,this.lastDetectionTime=(new Date).toISOString(),t.next=37,d.setMultiple({environmentType:r,detectedOrgId:i||this.detectedOrgId,detectionMethod:f,detectionSource:h,lastUpdated:this.lastDetectionTime});case 37:return e.tabId&&this.notifyTab(e.tabId,r,i),this.notifyEnvironmentChange(r,i),t.abrupt("return",!0);case 40:case"end":return t.stop()}}),t,this)}))),function(t){return l.apply(this,arguments)})},{key:"notifyEnvironmentChange",value:(s=S(I().mark((function t(e){var r,n=this,i=arguments;return I().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=i.length>1&&void 0!==i[1]?i[1]:null;try{chrome.tabs.query({url:["*://*.pure.cloud/*","*://*.mypurecloud.com/*","*://*.genesys.cloud/*"]},(function(t){o("Notifying ".concat(t.length," tabs about environment change to ").concat(e)),t.forEach((function(t){n.notifyTab(t.id,e,r)}))}))}catch(t){o("Error notifying tabs:",t)}case 2:case"end":return t.stop()}}),t)}))),function(t){return s.apply(this,arguments)})},{key:"clearTabEnvironmentCache",value:function(t){this.tabEnvironmentCache.has(t)&&(o("Clearing environment cache for tab ".concat(t)),this.tabEnvironmentCache.delete(t))}},{key:"notifyTab",value:function(t,e){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.tabEnvironmentCache.set(t,{environment:e,orgId:n,timestamp:Date.now()});try{chrome.tabs.sendMessage(t,{action:"updateBadge",environment:e,orgId:n},(function(i){chrome.runtime.lastError?(o("Content script might not be loaded in tab ".concat(t,", trying environmentChange message")),r.sendEnvironmentChangeMessage(t,e,n)):i&&i.success&&o("Tab ".concat(t," acknowledged badge update notification"))}))}catch(r){o("Error notifying tab ".concat(t,":"),r),this.sendEnvironmentChangeMessage(t,e,n)}}},{key:"sendEnvironmentChangeMessage",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{chrome.tabs.sendMessage(t,{action:"environmentChange",environment:e,orgId:r},(function(e){chrome.runtime.lastError?o("Tab ".concat(t," not ready for environment message: ").concat(chrome.runtime.lastError.message)):e&&e.success&&o("Tab ".concat(t," acknowledged environment change notification"))}))}catch(e){o("Error sending environment change to tab ".concat(t,":"),e)}}},{key:"setEnvironmentManually",value:(u=S(I().mark((function t(e){var r;return I().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e&&["dr","test","dev"].includes(e)){t.next=3;break}return o("Invalid environment specified for manual override:",e),t.abrupt("return",!1);case 3:return o("Manually setting environment to: ".concat(e)),r={environment:e,orgId:this.detectedOrgId,method:n.MANUAL_OVERRIDE.name,source:"user-override",confidence:n.MANUAL_OVERRIDE.confidence},t.next=7,this.updateEnvironment(r);case 7:return t.abrupt("return",!0);case 8:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"clearEnvironmentData",value:(c=S(I().mark((function t(){return I().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,o("Clearing all environment detection data"),this.currentEnvironment=null,this.detectedOrgId=null,this.lastDetectionMethod=null,this.lastDetectionSource=null,this.lastDetectionTime=null,this.processedUrls.clear(),t.next=10,d.removeMultiple(["environmentType","detectedOrgId","detectionMethod","detectionSource","lastUpdated"]);case 10:return this.notifyEnvironmentChange("unknown"),t.abrupt("return",!0);case 14:return t.prev=14,t.t0=t.catch(0),o("Error clearing environment data:",t.t0),t.abrupt("return",!1);case 18:case"end":return t.stop()}}),t,this,[[0,14]])}))),function(){return c.apply(this,arguments)})},{key:"refreshEnvironmentDetection",value:(a=S(I().mark((function t(){var e=this;return I().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,o("Triggering refresh of environment detection"),chrome.tabs.query({active:!0,url:["*://*.pure.cloud/*","*://*.mypurecloud.com/*","*://*.genesys.cloud/*"]},(function(t){t.forEach((function(t){e.checkUrlForEnvironment(t.id,t.url),chrome.tabs.sendMessage(t.id,{action:"redetectEnvironment"},(function(e){chrome.runtime.lastError||e&&e.success&&o("Tab ".concat(t.id," acknowledged redetection request"))}))}))})),t.abrupt("return",!0);case 6:return t.prev=6,t.t0=t.catch(0),o("Error refreshing environment detection:",t.t0),t.abrupt("return",!1);case 10:case"end":return t.stop()}}),t,null,[[0,6]])}))),function(){return a.apply(this,arguments)})},{key:"getCurrentState",value:function(){return{environmentType:this.currentEnvironment,detectedOrgId:this.detectedOrgId,detectionMethod:this.lastDetectionMethod,detectionSource:this.lastDetectionSource,lastUpdated:this.lastDetectionTime}}}],i&&P(r.prototype,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i,a,c,u,s,l,f,h,p}());function _(t){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_(t)}function A(){A=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new j(n||[]);return o(a,"_invoke",{value:I(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};s(w,a,(function(){return this}));var E=Object.getPrototypeOf,x=E&&E(E(D([])));x&&x!==r&&n.call(x,a)&&(w=x);var k=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function r(o,i,a,c){var u=f(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==_(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function I(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=T(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function T(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,T(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function j(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function D(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(_(e)+" is not iterable")}return g.prototype=b,o(k,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=s(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,s(t,u,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},L(O.prototype),s(O.prototype,c,(function(){return this})),e.AsyncIterator=O,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new O(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(k),s(k,u,"Generator"),s(k,a,(function(){return this})),s(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=D,j.prototype={constructor:j,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:D(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function z(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function R(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){z(i,n,o,a,c,"next",t)}function c(t){z(i,n,o,a,c,"throw",t)}a(void 0)}))}}function N(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,U(n.key),n)}}function U(t){var e=function(t){if("object"!=_(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=_(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==_(e)?e:e+""}const M=new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.initialized=!1,this.messageHandlers={}},e=[{key:"initialize",value:(v=R(A().mark((function t(){return A().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.initialized){t.next=2;break}return t.abrupt("return",!0);case 2:return t.prev=2,o("Initializing messaging service"),this.registerMessageHandlers(),this.setupMessageListener(),this.initialized=!0,o("Messaging service initialized"),t.abrupt("return",!0);case 11:return t.prev=11,t.t0=t.catch(2),o("Error initializing messaging service:",t.t0),t.abrupt("return",!1);case 15:case"end":return t.stop()}}),t,this,[[2,11]])}))),function(){return v.apply(this,arguments)})},{key:"registerMessageHandlers",value:function(){this.registerHandler("getCurrentEnvironment",this.handleGetCurrentEnvironment.bind(this)),this.registerHandler("setEnvironmentType",this.handleSetEnvironmentType.bind(this)),this.registerHandler("clearEnvironmentDetection",this.handleClearEnvironmentDetection.bind(this)),this.registerHandler("refreshEnvironmentDetection",this.handleRefreshEnvironmentDetection.bind(this)),this.registerHandler("reportOrganizationId",this.handleReportOrganizationId.bind(this)),this.registerHandler("strongDrPatternDetected",this.handleStrongDrPatternDetected.bind(this)),this.registerHandler("checkSpecificUrl",this.handleCheckSpecificUrl.bind(this)),this.registerHandler("syncStorageData",this.handleSyncStorageData.bind(this)),this.registerHandler("checkApiResponse",this.handleCheckApiResponse.bind(this)),this.registerHandler("checkOrganizationId",this.handleCheckOrganizationId.bind(this))}},{key:"registerHandler",value:function(t,e){this.messageHandlers[t]=e,o("Registered message handler for action: ".concat(t))}},{key:"setupMessageListener",value:function(){var t=this;chrome.runtime.onMessage.addListener((function(e,r,n){return t.handleMessage(e,r,n),!0}))}},{key:"handleMessage",value:(p=R(A().mark((function t(e,r,n){var i,a,c;return A().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,i=e.action){t.next=6;break}return o("Received message without action:",e),n({success:!1,error:"No action specified"}),t.abrupt("return");case 6:if(o("Received message with action: ".concat(i),e),a=this.messageHandlers[i]){t.next=12;break}return o("No handler found for action: ".concat(i)),n({success:!1,error:"Unknown action: ".concat(i)}),t.abrupt("return");case 12:return t.next=14,a(e,r);case 14:c=t.sent,n(c),t.next=22;break;case 18:t.prev=18,t.t0=t.catch(0),o("Error handling message:",t.t0),n({success:!1,error:t.t0.message});case 22:case"end":return t.stop()}}),t,this,[[0,18]])}))),function(t,e,r){return p.apply(this,arguments)})},{key:"handleGetCurrentEnvironment",value:(h=R(A().mark((function t(e,r){var n,o,i;return A().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=D.getCurrentState(),!e.url){t.next=7;break}return o=r.tab?r.tab.id:null,t.next=5,D.checkUrlForEnvironment(o,e.url);case 5:return i=D.getCurrentState(),t.abrupt("return",i);case 7:return t.abrupt("return",n);case 8:case"end":return t.stop()}}),t)}))),function(t,e){return h.apply(this,arguments)})},{key:"handleSetEnvironmentType",value:(f=R(A().mark((function t(e){return A().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,D.setEnvironmentManually(e.environmentType);case 2:if(!t.sent){t.next=7;break}return t.abrupt("return",{success:!0,environment:e.environmentType,message:"Environment manually set to ".concat(e.environmentType)});case 7:return t.abrupt("return",{success:!1,error:"Failed to set environment manually"});case 8:case"end":return t.stop()}}),t)}))),function(t){return f.apply(this,arguments)})},{key:"handleClearEnvironmentDetection",value:(l=R(A().mark((function t(){return A().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,D.clearEnvironmentData();case 2:if(!t.sent){t.next=7;break}return t.abrupt("return",{success:!0,message:"Environment detection data cleared"});case 7:return t.abrupt("return",{success:!1,error:"Failed to clear environment detection data"});case 8:case"end":return t.stop()}}),t)}))),function(){return l.apply(this,arguments)})},{key:"handleRefreshEnvironmentDetection",value:(s=R(A().mark((function t(){return A().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,D.refreshEnvironmentDetection();case 2:if(!t.sent){t.next=7;break}return t.abrupt("return",{success:!0,message:"Environment detection refresh triggered"});case 7:return t.abrupt("return",{success:!1,error:"Failed to trigger environment detection refresh"});case 8:case"end":return t.stop()}}),t)}))),function(){return s.apply(this,arguments)})},{key:"handleReportOrganizationId",value:(u=R(A().mark((function t(e,r){var n,o,i,a;return A().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.orgId,o=e.source,i=r.tab?r.tab.id:null,t.next=4,D.processOrganizationId(n,o,i);case 4:if(!(a=t.sent)){t.next=9;break}return t.abrupt("return",{success:!0,environment:a.environment,message:"Organization ID processed successfully, environment: ".concat(a.environment)});case 9:return t.abrupt("return",{success:!1,error:"Failed to process organization ID"});case 10:case"end":return t.stop()}}),t)}))),function(t,e){return u.apply(this,arguments)})},{key:"handleStrongDrPatternDetected",value:(c=R(A().mark((function t(e,r){var n,i,a,c;return A().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.pattern,i=e.url,a=r.tab?r.tab.id:null,o("Strong DR pattern detected in tab ".concat(a,": ").concat(n," (").concat(i,")")),t.next=5,D.checkUrlForEnvironment(a,i);case 5:if(!(c=t.sent)||"dr"!==c.environment){t.next=10;break}return t.abrupt("return",{success:!0,environment:"dr",message:"Strong DR pattern processed successfully"});case 10:return t.abrupt("return",{success:!1,error:"Failed to process strong DR pattern"});case 11:case"end":return t.stop()}}),t)}))),function(t,e){return c.apply(this,arguments)})},{key:"handleCheckSpecificUrl",value:(a=R(A().mark((function t(e){var r,n,o;return A().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.url,n=e.tabId,t.next=3,D.checkUrlForEnvironment(n,r);case 3:if(!(o=t.sent)){t.next=8;break}return t.abrupt("return",{success:!0,environment:o.environment,method:o.method,source:o.source,message:"URL checked successfully, environment: ".concat(o.environment)});case 8:return t.abrupt("return",{success:!0,message:"URL checked, no environment indicators found"});case 9:case"end":return t.stop()}}),t)}))),function(t){return a.apply(this,arguments)})},{key:"handleSyncStorageData",value:(i=R(A().mark((function t(e){var r;return A().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((r=e.data)&&"object"===_(r)){t.next=3;break}return t.abrupt("return",{success:!1,error:"Invalid data for storage sync"});case 3:return t.next=5,d.setMultiple(r);case 5:if(!t.sent){t.next=10;break}return t.abrupt("return",{success:!0,message:"Storage data synced successfully"});case 10:return t.abrupt("return",{success:!1,error:"Failed to sync storage data"});case 11:case"end":return t.stop()}}),t)}))),function(t){return i.apply(this,arguments)})},{key:"handleCheckApiResponse",value:(n=R(A().mark((function t(e){var r,n,i,a,c,u,s;return A().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.data,n=e.url,t.prev=1,r){t.next=4;break}return t.abrupt("return",{success:!1,error:"No API response data provided"});case 4:i="string"==typeof r?r:JSON.stringify(r),a=0,c=Object.keys(D.ORGANIZATION_MAPPINGS);case 6:if(!(a<c.length)){t.next=18;break}if(u=c[a],!i.includes(u)){t.next=15;break}return o("Found organization ID ".concat(u," in API response")),t.next=12,D.processOrganizationId(u,"api-response:".concat(n));case 12:if(!(s=t.sent)){t.next=15;break}return t.abrupt("return",{success:!0,environment:s.environment,orgId:u,message:"Found organization ID in API response, environment: ".concat(s.environment)});case 15:a++,t.next=6;break;case 18:return t.abrupt("return",{success:!0,message:"API response checked, no known organization IDs found"});case 21:return t.prev=21,t.t0=t.catch(1),o("Error checking API response:",t.t0),t.abrupt("return",{success:!1,error:t.t0.message});case 25:case"end":return t.stop()}}),t,null,[[1,21]])}))),function(t){return n.apply(this,arguments)})},{key:"handleCheckOrganizationId",value:(r=R(A().mark((function t(e,r){var n,o,i,a;return A().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.orgId,o=e.source,i=r.tab?r.tab.id:null,t.next=4,D.processOrganizationId(n,o,i);case 4:if(!(a=t.sent)){t.next=9;break}return t.abrupt("return",{success:!0,environment:a.environment,message:"Organization ID processed successfully, environment: ".concat(a.environment)});case 9:return t.abrupt("return",{success:!1,error:"Failed to process organization ID"});case 10:case"end":return t.stop()}}),t)}))),function(t,e){return r.apply(this,arguments)})}],e&&N(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,i,a,c,u,s,l,f,h,p,v}());function G(t){return G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},G(t)}function F(t,e){if(t){if("string"==typeof t)return C(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?C(t,e):void 0}}function C(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function H(){H=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new j(n||[]);return o(a,"_invoke",{value:I(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};s(w,a,(function(){return this}));var E=Object.getPrototypeOf,x=E&&E(E(D([])));x&&x!==r&&n.call(x,a)&&(w=x);var k=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function r(o,i,a,c){var u=f(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==G(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function I(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=T(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function T(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,T(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function j(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function D(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(G(e)+" is not iterable")}return g.prototype=b,o(k,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=s(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,s(t,u,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},L(O.prototype),s(O.prototype,c,(function(){return this})),e.AsyncIterator=O,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new O(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(k),s(k,u,"Generator"),s(k,a,(function(){return this})),s(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=D,j.prototype={constructor:j,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:D(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function V(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function Y(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){V(i,n,o,a,c,"next",t)}function c(t){V(i,n,o,a,c,"throw",t)}a(void 0)}))}}function q(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,W(n.key),n)}}function W(t){var e=function(t){if("object"!=G(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=G(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==G(e)?e:e+""}var B=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.initialized=!1,this.trackedTabs=new Map},e=[{key:"initialize",value:(n=Y(H().mark((function t(){return H().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.initialized){t.next=2;break}return t.abrupt("return",!0);case 2:return t.prev=2,o("Initializing tab monitor"),this.setupTabEventListeners(),t.next=7,this.scanExistingTabs();case 7:return this.initialized=!0,o("Tab monitor initialized"),t.abrupt("return",!0);case 12:return t.prev=12,t.t0=t.catch(2),o("Error initializing tab monitor:",t.t0),t.abrupt("return",!1);case 16:case"end":return t.stop()}}),t,this,[[2,12]])}))),function(){return n.apply(this,arguments)})},{key:"setupTabEventListeners",value:function(){chrome.tabs.onUpdated.addListener(this.handleTabUpdated.bind(this)),chrome.tabs.onRemoved.addListener(this.handleTabRemoved.bind(this)),chrome.tabs.onActivated.addListener(this.handleTabActivated.bind(this)),o("Tab event listeners set up")}},{key:"handleTabActivated",value:function(t){var e=this;try{o("Tab ".concat(t.tabId," activated")),chrome.tabs.get(t.tabId,(function(r){chrome.runtime.lastError?o("Error getting tab info: ".concat(chrome.runtime.lastError.message)):r&&r.url&&(o("Tab ".concat(t.tabId," has URL: ").concat(r.url)),e.processActivatedTab(r.id,r.url))}))}catch(t){o("Error handling tab activation: ".concat(t))}}},{key:"processActivatedTab",value:function(t,e){var r=this;this.isGenesysCloudUrl(e)&&(o("Activated tab ".concat(t," has Genesys Cloud URL: ").concat(e)),this.trackTab(t,e),D.checkUrlForEnvironment(t,e),e.includes("/api/v2/")||setTimeout((function(){r.injectDetectionScript(t,e)}),100),setTimeout((function(){var e=D.getCurrentState().environment;e&&D.notifyTab(t,e)}),200))}},{key:"scanExistingTabs",value:(r=Y(H().mark((function t(){var e=this;return H().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){chrome.tabs.query({url:w.map((function(t){return"*://*.".concat(t,"/*")}))},(function(r){o("Found ".concat(r.length," existing Genesys Cloud tabs")),r.forEach((function(t){e.trackTab(t.id,t.url),D.checkUrlForEnvironment(t.id,t.url)})),t()}))})));case 1:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})},{key:"handleTabUpdated",value:function(t,e,r){var n=this,i=void 0!==e.url;if((i||"complete"===e.status)&&r.url)if(this.isGenesysCloudUrl(r.url)){var a=this.trackedTabs.has(t)?this.trackedTabs.get(t).url:null,c=a!==r.url;o(c?"Tab ".concat(t," URL changed from ").concat(a," to ").concat(r.url):"Tab ".concat(t," updated with Genesys Cloud URL: ").concat(r.url)),this.trackTab(t,r.url),c&&"loading"===e.status&&(o("Potential bookmark navigation detected, forcing environment reset for tab ".concat(t)),D.clearTabEnvironmentCache(t)),D.checkUrlForEnvironment(t,r.url),r.url.includes("/api/v2/")||setTimeout((function(){n.injectDetectionScript(t,r.url)}),i?100:1e3),(i||c)&&setTimeout((function(){var e=D.getCurrentState().environment;e&&D.notifyTab(t,e)}),500)}else this.trackedTabs.has(t)&&(o("Tab ".concat(t," no longer has Genesys Cloud URL: ").concat(r.url)),this.trackedTabs.delete(t))}},{key:"handleTabRemoved",value:function(t){this.trackedTabs.has(t)&&(o("Tracked tab ".concat(t," was closed")),this.trackedTabs.delete(t))}},{key:"trackTab",value:function(t,e){this.trackedTabs.set(t,{url:e,lastChecked:Date.now()}),o("Now tracking tab ".concat(t," with URL: ").concat(e))}},{key:"isGenesysCloudUrl",value:function(t){try{return w.some((function(e){return t.includes(e)}))}catch(t){return o("Error checking if URL is Genesys Cloud URL:",t),!1}}},{key:"injectDetectionScript",value:function(t,e){try{if(-1===t)return;o("Injecting detection script into tab ".concat(t)),chrome.scripting.executeScript({target:{tabId:t},func:function(){for(var t={"d9ee1fd7-868c-4ea0-af89-5b9813db863d":"test","c8548bdb-bad5-4fc2-9d77-2d6a54aac157":"dr","a7cbe8fc-fe81-47bc-bdd3-05a726c56c5a":"dev"},e=null,r=null,n=0;n<localStorage.length;n++){for(var o=localStorage.key(n),i=localStorage.getItem(o),a=0,c=Object.keys(t);a<c.length;a++){var u=c[a];if(i&&i.includes(u)){e=u,r="localStorage:".concat(o);break}}if(e)break}e?chrome.runtime.sendMessage({action:"reportOrganizationId",orgId:e,source:r||"direct-extraction"}):chrome.runtime.sendMessage({action:"extractOrgIdFromPage"})}}).catch((function(e){o("Error injecting script into tab ".concat(t,":"),e)}))}catch(e){o("Error setting up script injection for tab ".concat(t,":"),e)}}},{key:"getTrackedTabs",value:function(){return this.trackedTabs}},{key:"refreshAllTabs",value:function(){var t,e=function(t){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=F(t))){e&&(t=e);var r=0,n=function(){};return{s:n,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,a=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==e.return||e.return()}finally{if(a)throw o}}}}(this.trackedTabs.entries());try{var r=function(){var e=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,s=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==e);u=!0);}catch(t){s=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(t,e)||F(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t.value,2),r=e[0],n=e[1];o("Refreshing environment detection for tab ".concat(r)),D.checkUrlForEnvironment(r,n.url);try{chrome.tabs.sendMessage(r,{action:"redetectEnvironment"},(function(t){chrome.runtime.lastError||o("Tab ".concat(r," acknowledged refresh request"))}))}catch(t){o("Error sending refresh message to tab ".concat(r,":"),t)}n.lastChecked=Date.now()};for(e.s();!(t=e.n()).done;)r()}catch(t){e.e(t)}finally{e.f()}}}],e&&q(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();const J=new B;function $(t){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$(t)}function Z(){Z=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new j(n||[]);return o(a,"_invoke",{value:I(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};s(w,a,(function(){return this}));var E=Object.getPrototypeOf,x=E&&E(E(D([])));x&&x!==r&&n.call(x,a)&&(w=x);var k=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function r(o,i,a,c){var u=f(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==$(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function I(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=T(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function T(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,T(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function j(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function D(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError($(e)+" is not iterable")}return g.prototype=b,o(k,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=s(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,s(t,u,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},L(O.prototype),s(O.prototype,c,(function(){return this})),e.AsyncIterator=O,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new O(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(k),s(k,u,"Generator"),s(k,a,(function(){return this})),s(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=D,j.prototype={constructor:j,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:D(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function K(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function Q(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){K(i,n,o,a,c,"next",t)}function c(t){K(i,n,o,a,c,"throw",t)}a(void 0)}))}}function X(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,tt(n.key),n)}}function tt(t){var e=function(t){if("object"!=$(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=$(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==$(e)?e:e+""}const et=new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.initialized=!1,this.processedUrls=new Set},e=[{key:"initialize",value:(i=Q(Z().mark((function t(){return Z().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.initialized){t.next=2;break}return t.abrupt("return",!0);case 2:return t.prev=2,o("Initializing API monitor"),this.setupWebRequestListener(),this.initialized=!0,o("API monitor initialized"),t.abrupt("return",!0);case 10:return t.prev=10,t.t0=t.catch(2),o("Error initializing API monitor:",t.t0),t.abrupt("return",!1);case 14:case"end":return t.stop()}}),t,this,[[2,10]])}))),function(){return i.apply(this,arguments)})},{key:"setupWebRequestListener",value:function(){chrome.webRequest?(chrome.webRequest.onCompleted.addListener(this.handleApiResponse.bind(this),{urls:["*://*.pure.cloud/api/v2/*","*://*.mypurecloud.com/api/v2/*","*://*.genesys.cloud/api/v2/*"]}),o("Web request listener set up successfully")):o("Web request API not available, cannot monitor API requests")}},{key:"handleApiResponse",value:function(t){var e=this;if(r.some((function(e){return t.url.includes(e)}))&&-1!==t.tabId){var n=t.url.split("?")[0];this.processedUrls.has(n)||(this.processedUrls.add(n),o("Relevant API response detected: ".concat(n," (Tab ID: ").concat(t.tabId,")")),setTimeout((function(){e.injectApiDetectionScript(t.tabId,t.url)}),300))}}},{key:"injectApiDetectionScript",value:function(t,e){if(-1!==t)try{o("Injecting API detection script into tab ".concat(t," for URL ").concat(e)),chrome.scripting.executeScript({target:{tabId:t},func:function(){chrome.runtime.sendMessage({action:"extractOrgIdFromPage",source:"api-response"})}}).catch((function(e){o("Error injecting API detection script into tab ".concat(t,":"),e)}))}catch(e){o("Error setting up API detection script injection for tab ".concat(t,":"),e)}}},{key:"cleanupProcessedUrls",value:function(){this.processedUrls.size>1e3&&(o("Cleaning up processed URLs list (size: ".concat(this.processedUrls.size,")")),this.processedUrls.clear())}},{key:"getProcessedUrlCount",value:function(){return this.processedUrls.size}},{key:"processApiResponse",value:(n=Q(Z().mark((function t(e,r){var n,i,a,c,u=arguments;return Z().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=u.length>2&&void 0!==u[2]?u[2]:null,t.prev=1,r){t.next=5;break}return o("No API response data provided"),t.abrupt("return",!1);case 5:"string"==typeof r||JSON.stringify(r),i=null;try{"object"===$(r)&&r.organization&&r.organization.id?(i=r.organization.id,o("Found organization ID in API response object: ".concat(i))):"string"==typeof r&&(a=JSON.parse(r)).organization&&a.organization.id&&(i=a.organization.id,o("Found organization ID in parsed API response: ".concat(i)))}catch(t){o("Could not extract organization ID from API response data")}if(!i){t.next=13;break}return t.next=11,D.processOrganizationId(i,"api-response:".concat(e),n);case 11:return c=t.sent,t.abrupt("return",!!c);case 13:return t.abrupt("return",!1);case 16:return t.prev=16,t.t0=t.catch(1),o("Error processing API response:",t.t0),t.abrupt("return",!1);case 20:case"end":return t.stop()}}),t,null,[[1,16]])}))),function(t,e){return n.apply(this,arguments)})}],e&&X(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,i}());function rt(t){return rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rt(t)}function nt(){nt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new j(n||[]);return o(a,"_invoke",{value:I(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};s(w,a,(function(){return this}));var E=Object.getPrototypeOf,x=E&&E(E(D([])));x&&x!==r&&n.call(x,a)&&(w=x);var k=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function r(o,i,a,c){var u=f(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==rt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function I(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=T(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function T(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,T(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function j(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function D(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(rt(e)+" is not iterable")}return g.prototype=b,o(k,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=s(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,s(t,u,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},L(O.prototype),s(O.prototype,c,(function(){return this})),e.AsyncIterator=O,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new O(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(k),s(k,u,"Generator"),s(k,a,(function(){return this})),s(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=D,j.prototype={constructor:j,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:D(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function ot(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function it(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){ot(i,n,o,a,c,"next",t)}function c(t){ot(i,n,o,a,c,"throw",t)}a(void 0)}))}}function at(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ct(n.key),n)}}function ct(t){var e=function(t){if("object"!=rt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=rt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==rt(e)?e:e+""}const ut=new(function(){return e=function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.initialized=!1,this.detectedOrgIds=new Map,this.orgMappings=t},r=[{key:"initialize",value:(i=it(nt().mark((function t(){var e,r;return nt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.initialized){t.next=2;break}return t.abrupt("return",!0);case 2:return t.prev=2,o("Initializing organization ID monitor"),t.next=6,D.getCurrentState();case 6:return e=t.sent,(r=e.detectedOrgId)&&o("Loaded existing organization ID from storage: ".concat(r)),this.initialized=!0,o("Organization ID monitor initialized"),t.abrupt("return",!0);case 14:return t.prev=14,t.t0=t.catch(2),o("Error initializing organization ID monitor:",t.t0),t.abrupt("return",!1);case 18:case"end":return t.stop()}}),t,this,[[2,14]])}))),function(){return i.apply(this,arguments)})},{key:"processOrganizationId",value:(n=it(nt().mark((function t(e,r){var n,i,a=arguments;return nt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=a.length>2&&void 0!==a[2]?a[2]:null,e&&"string"==typeof e){t.next=4;break}return o("Invalid organization ID:",e),t.abrupt("return",null);case 4:if(this.isValidGuid(e)){t.next=7;break}return o("Invalid GUID format for organization ID: ".concat(e)),t.abrupt("return",null);case 7:if(i=this.orgMappings[e]){t.next=11;break}return o("Organization ID ".concat(e," not found in mappings")),t.abrupt("return",null);case 11:return o("Valid organization ID detected: ".concat(e," (").concat(i,")")),n&&this.trackOrgIdForTab(n,e,r),t.next=15,D.processOrganizationId(e,r,n);case 15:return t.abrupt("return",t.sent);case 16:case"end":return t.stop()}}),t,this)}))),function(t,e){return n.apply(this,arguments)})},{key:"trackOrgIdForTab",value:function(t,e,r){this.detectedOrgIds.set(t,{orgId:e,source:r,timestamp:Date.now()}),o("Now tracking organization ID ".concat(e," for tab ").concat(t))}},{key:"isValidGuid",value:function(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}},{key:"getOrgIdForTab",value:function(t){var e=this.detectedOrgIds.get(t);return e?e.orgId:null}},{key:"getAllTrackedOrgIds",value:function(){return this.detectedOrgIds}},{key:"clearOrgIdForTab",value:function(t){this.detectedOrgIds.has(t)&&(o("Clearing tracked organization ID for tab ".concat(t)),this.detectedOrgIds.delete(t))}},{key:"clearAllTrackedOrgIds",value:function(){o("Clearing all tracked organization IDs"),this.detectedOrgIds.clear()}},{key:"isDrOrgId",value:function(t){return"dr"===this.orgMappings[t]}},{key:"isTestOrgId",value:function(t){return"test"===this.orgMappings[t]}},{key:"isDevOrgId",value:function(t){return"dev"===this.orgMappings[t]}},{key:"addOrgMapping",value:function(t,e){return this.isValidGuid(t)&&["dr","test","dev"].includes(e)?(this.orgMappings[t]=e,o("Added new organization ID mapping: ".concat(t," -> ").concat(e)),!0):(o("Invalid organization ID or environment: ".concat(t,", ").concat(e)),!1)}}],r&&at(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n,i}());function st(t){return st="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},st(t)}function lt(){lt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new j(n||[]);return o(a,"_invoke",{value:I(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};s(w,a,(function(){return this}));var E=Object.getPrototypeOf,x=E&&E(E(D([])));x&&x!==r&&n.call(x,a)&&(w=x);var k=b.prototype=m.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function r(o,i,a,c){var u=f(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==st(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function I(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=T(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function T(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,T(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function j(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function D(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(st(e)+" is not iterable")}return g.prototype=b,o(k,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=s(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,s(t,u,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},L(O.prototype),s(O.prototype,c,(function(){return this})),e.AsyncIterator=O,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new O(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(k),s(k,u,"Generator"),s(k,a,(function(){return this})),s(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=D,j.prototype={constructor:j,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:D(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function ft(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function ht(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){ft(i,n,o,a,c,"next",t)}function c(t){ft(i,n,o,a,c,"throw",t)}a(void 0)}))}}function pt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,dt(n.key),n)}}function dt(t){var e=function(t){if("object"!=st(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=st(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==st(e)?e:e+""}var vt=new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.initialized=!1},e=[{key:"initialize",value:(c=ht(lt().mark((function t(){return lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.initialized){t.next=3;break}return o("Background already initialized, skipping"),t.abrupt("return");case 3:return o("Initializing background script services"),t.prev=4,t.next=7,d.initialize();case 7:return t.next=9,D.initialize();case 9:return t.next=11,ut.initialize();case 11:return t.next=13,et.initialize();case 13:return t.next=15,J.initialize();case 15:return t.next=17,M.initialize();case 17:this.setupInstallHandler(),this.initialized=!0,o("Background script initialization complete"),t.next=25;break;case 22:t.prev=22,t.t0=t.catch(4),o("Error initializing background script:",t.t0);case 25:case"end":return t.stop()}}),t,this,[[4,22]])}))),function(){return c.apply(this,arguments)})},{key:"setupInstallHandler",value:function(){var t=this;chrome.runtime.onInstalled.addListener((function(e){"install"===e.reason?(o("Extension installed"),t.handleFirstInstall()):"update"===e.reason&&(o("Extension updated from ".concat(e.previousVersion," to ").concat(chrome.runtime.getManifest().version)),t.handleUpdate(e.previousVersion))}))}},{key:"handleFirstInstall",value:(a=ht(lt().mark((function t(){return lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o("Handling first-time installation"),t.next=3,d.set("installDate",(new Date).toISOString());case 3:case"end":return t.stop()}}),t)}))),function(){return a.apply(this,arguments)})},{key:"handleUpdate",value:(i=ht(lt().mark((function t(e){return lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o("Handling update from version ".concat(e)),t.next=3,d.set("lastUpdateDate",(new Date).toISOString());case 3:return t.next=5,d.set("previousVersion",e);case 5:if(!e||!e.startsWith("1.")){t.next=9;break}return o("Migrating from v1.x format"),t.next=9,this.migrateFromV1();case 9:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"migrateFromV1",value:(n=ht(lt().mark((function t(){return lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.get("needsV1Migration");case 2:if(!1!==t.sent){t.next=6;break}return o("Migration already performed, skipping"),t.abrupt("return");case 6:return o("Migrating data from v1.x format"),t.prev=7,t.next=10,d.set("needsV1Migration",!1);case 10:o("Migration completed successfully"),t.next=18;break;case 13:return t.prev=13,t.t0=t.catch(7),o("Error during migration:",t.t0),t.next=18,d.set("needsV1Migration",!0);case 18:case"end":return t.stop()}}),t,null,[[7,13]])}))),function(){return n.apply(this,arguments)})},{key:"shutdown",value:(r=ht(lt().mark((function t(){return lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o("Shutting down background services"),this.initialized=!1,o("Background services shutdown complete");case 3:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})}],e&&pt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,i,a,c}());vt.initialize(),self.addEventListener("unload",(function(){vt.shutdown()}))})();