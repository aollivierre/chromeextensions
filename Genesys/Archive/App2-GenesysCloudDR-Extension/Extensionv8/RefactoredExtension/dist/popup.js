(()=>{"use strict";document.addEventListener("DOMContentLoaded",(function(){var e=document.getElementById("environment-badge"),t=document.getElementById("org-id"),n=document.getElementById("detection-method"),o=document.getElementById("detection-source"),r=document.getElementById("last-updated"),d=document.getElementById("refresh-button");function c(){chrome.tabs.query({active:!0,currentWindow:!0},(function(e){0!==e.length?function(e){try{return["pure.cloud","mypurecloud.com","genesys.cloud"].some((function(t){return e.includes(t)}))}catch(e){return console.error("Error checking if URL is Genesys Cloud URL:",e),!1}}(e[0].url||"")?chrome.storage.sync.get(["environmentType","detectedOrgId","detectionMethod","detectionSource","lastUpdated"],(function(e){i(e)})):i({environmentType:"unknown",detectionMethod:"Not applicable",detectionSource:"Not on Genesys Cloud site",lastUpdated:(new Date).toISOString()}):i({environmentType:"unknown"})}))}function i(d){var c=d.environmentType||"unknown";if(e.textContent=c.toUpperCase(),e.className="badge "+c,"dr"===c&&"Organization ID"!==d.detectionMethod?t.textContent="Not required for DR":d.detectedOrgId?t.textContent=d.detectedOrgId:t.textContent="Not detected",d.detectionMethod?n.textContent=d.detectionMethod:n.textContent="Not detected",d.detectionSource?o.textContent=d.detectionSource:o.textContent="Not detected",d.lastUpdated){var i=new Date(d.lastUpdated);r.textContent=i.toLocaleString()}else r.textContent="Never"}c(),d.addEventListener("click",(function(){chrome.tabs.query({active:!0,currentWindow:!0},(function(e){if(0!==e.length){var t=e[0];chrome.tabs.sendMessage(t.id,{action:"redetectEnvironment"},(function(e){chrome.runtime.lastError&&(function(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];(e=console).log.apply(e,["[Environment Extension]"].concat(n))}("Error sending message:",chrome.runtime.lastError),chrome.runtime.sendMessage({action:"refreshEnvironmentDetection",tabId:t.id})),setTimeout((function(){c()}),500)}))}}))}))}))})();